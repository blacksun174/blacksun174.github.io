---
layout: post
title:  "1つの処理は1つの言語で書くこと"
date:   2021-06-25 18:30:00 +0900
categories: program, maintenance
---
# 1つの処理は1つの言語で書くこと
仕事上でデータ分析基盤を担当しているので、ちょっとした処理を書くことが多いです。
特には他の人を書いたコードを違うプラットフォームに移植することが多いです。
今回は、シェルコマンドとpythonを交互に使うシェルスクリプトをdigdagの環境に移植することになりました。これはひどい。
mysqlコマンドでsqlを実行し、クエリの結果をCSVに出力し、Pythonでパスして結果を出力し、さらに他のPythonで出力し、それをRedshiftクエリを投げて結果をCSVを出力し、
CSVの内容をまとめてSlackに通知するような、複雑な処理を1つのシェルスクリプトで書かれている。

これは何が良くないというと、pythonだけで書けばよかったのに、わざわざシェルとか使っていると、移植性が下がり、移植にコストがかかりすぎですね。
例えば、pythonだけで書かれているなら、それをdigdagにほぼ何も修正する必要がなく、移植できる。
シェルコマンドとpythonを組み合わせて使うと、移植するコストが１０倍になった気がします。。。

自戒をこめてこういうものを作らないようにしたい
